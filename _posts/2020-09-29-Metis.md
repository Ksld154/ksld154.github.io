---
title: "Interpreting Deep Learning-Based Networking Systems"
tags: ["Paper", "SIGCOMM", "2020", "DL", "Learning", "Decision Tree" ]
show_edit_on_github: false
---

## 1 Background & Issues
*  DNN modelsæ¶‰åŠæ•¸ç™¾è¬å€‹ä»¥ä¸Šçš„åƒæ•¸èˆ‡neuronsï¼Œç•¶é‹ç”¨åœ¨ç¶²è·¯ç³»çµ±ä¸Šæ™‚ï¼Œå°ç¶²ç®¡äººå“¡ä¾†èªªåƒæ˜¯é»‘ç›’å­ï¼Œæœƒé‡åˆ°ä»¥ä¸‹å•é¡Œ
    *  DNNæ¶æ§‹é›£ä»¥ç†è§£ï¼Œé€ æˆçµæœä¸å¦‚é æœŸæ™‚å¾ˆé›£debug
    *  éå¸¸é›£é‡å°ç¶²è·¯ç‹€æ…‹åšæ‰‹å‹•çš„å³æ™‚èª¿æ•´policy
    *  å¤ªè€—é‹ç®—è³‡æºï¼Œdeployæ™‚è¦è€ƒæ…®ç¡¬é«”èƒ½åŠ›ï¼Œdecision latencyä¹Ÿå¾ˆé«˜
*  å› æ­¤æˆ‘å€‘éœ€è¦ä¸€å¥—frameworkå¯ä»¥interpretç¶²è·¯ç³»çµ±ä¸­DNN modelï¼Œæ–¹ä¾¿ç¶²ç®¡äººå“¡å‹•æ…‹èª¿æ•´ç¶²è·¯traffic


## 2 Motivation (ç¾æœ‰è§£æ³•çš„ä¸è¶³/è¨­è¨ˆä¸Šçš„æŒ‘æˆ°)
ç¾åœ¨ä¹Ÿæ˜¯æœ‰å¹¾å¥—é‡å°DL-based network systemçš„interpretion toolï¼Œä½†å®ƒå€‘åœ¨å¹¾å€‹é¢å‘ä¸Šä»æœ‰æ‰€ä¸è¶³

1. **ä¸å¤ Generalï¼Œç„¡æ³•é€šç”¨æ–¼æ‰€æœ‰Network systems**
    * ç¾æœ‰çš„è©®é‡‹å·¥å…·åªèƒ½é©ç”¨æ–¼æŸä¸€ç¨®DLæ¨¡å‹
        * åƒæ˜¯LEMMAé€™å¥—å·¥å…·ï¼Œåªèƒ½ç”¨æ–¼è©®é‡‹RNN-based network system
    * ä½†ç¶²è·¯ç³»çµ±å¯èƒ½æ˜¯FNN, GNN, RNN ç­‰ç­‰
    
2. **è©®é‡‹é‡é»æ”¾åœ¨ç†è§£DNNæ¨¡å‹çš„å…§éƒ¨æ©Ÿåˆ¶**
    * e.g. æ‰¾å‡ºå…§éƒ¨neuronsæœƒè¢«å“ªäº›input featuresæ¿€ç™¼
    * ä½†å°±ç¶²ç®¡äººå“¡çš„è§’åº¦ï¼Œè©®é‡‹é‡é»æ˜¯å¾—çŸ¥inputå’Œoutputä¹‹é–“çš„é—œä¿‚
    
3. **Non-standard state and action spaces**
    * ç¾æœ‰è¼ƒæˆç†Ÿçš„DNN interpretion toolsï¼Œä¸»è¦é‡å°åœ–ç‰‡æˆ–å¥å­é€™ç¨®well-structured vector input
    * ç¶²è·¯ç³»çµ±çš„DL modelï¼Œinputå¯èƒ½æ˜¯topologyï¼Œoutputå¯èƒ½æ˜¯pathï¼Œencodeæ–¹å¼ä»ä¸å¤ æˆç†Ÿï¼Œä¸¦ä¸é©åˆå°‡ä¸Šè¿°å·¥å…·æ¬ä¾†ç”¨
    
## 3 Introduction
*   **Metis:** ä¸€å¥—frameworkï¼Œå¯ä»¥å°‡å„ç¨®DL-based networking systemè©®é‡‹æˆäººé¡å¯ç†è§£çš„control policy
*   **ä¸å—é™æ–¼ç‰¹å®šDLæ¨¡å‹:** 
    * å°‡Network systemåˆ†æˆå…©é¡ï¼ŒLocal Systemå’ŒGlobal System
*   **Local System**
    *   åªåœ¨ä¸€å°æ©Ÿå™¨ä¸Šæ”¶é›†è³‡è¨Šä¸¦ä¸‹æ±ºå®š
    *   é€é**teacher-student training(çŸ¥è­˜è’¸é¤¾)**ï¼Œå°‡DNNæ¨¡å‹è½‰åŒ–æˆdecision tree(rule-based)
        *   è¨­è¨ˆç‰¹æ®Šå‰ªææ–¹æ³•ï¼Œå°‡decision treeçš„leafæ•¸å£“åœ¨äººé¡èƒ½ç†è§£çš„ç¯„åœ:
            *   **Resample:** DNN policyçš„æ¯ä¸€çµ„data(input, output)é‡è¦æ€§ä¸¦ä¸åŒï¼Œé€™é‚Šæ¡ç”¨RLçš„advange functionæ±ºå®šæ¯çµ„dataçš„sampleæ©Ÿç‡
            *   ä¹Ÿèƒ½ä¾æ“šç¶²ç®¡äººå“¡çš„éœ€æ±‚ï¼Œå‹•æ…‹æ±ºå®šå‰ªæç¨‹åº¦

*   **Global System**
    *   åœ¨æ•´å€‹ç¶²è·¯æ‹“æ¨¸ä¸Šæ”¶é›†è³‡è¨Šä¸¦ä¸‹æ±ºå®š
    *   å°‡æ•´å€‹å•é¡Œformulateæˆä¸€å¼µhypergraph
        * å› ç‚ºç¶²è·¯å•é¡Œé€šå¸¸æœ‰graph input
        * æˆ–æ˜¯å»ºç«‹2 variables mapping (e.g. resource allocation)
    *   Metisèƒ½å°‡åŸå…ˆçš„ç¶²è·¯å•é¡Œï¼Œè½‰åŒ–æˆ**è¨ˆç®—**hypergraphä¸Šé‡è¦çš„componentçš„æœ€ä½³åŒ–å•é¡Œ
        * e.g. è¨ˆç®—SDNä¸Šçš„æœ€ä½³è·¯å¾‘
            * Vertice: Physical Link
            * Hyperedge: Path(src-dst pair)
            * æ–°å•é¡Œ: å“ªäº›vertice-edge connectionï¼Œå°æ•´å€‹ç¶²è·¯æ‹“æ¨¸çš„æœ€ä½³routingè§£æ˜¯æœ‰**é‡è¦å½±éŸ¿**çš„
    
## 4 Decision Tree Interpretation
* ç”¨Decision Treeçš„åŸå› 
    1. Local Network Systemé€šå¸¸ç”¨rule-based policiesåšæ±ºå®šï¼Œé€™å¾ˆåƒdecision treeåšæ±ºå®šçš„é‚è¼¯
        * e.g. switchçš„flow schedulingé€šå¸¸æ˜¯ä»¥ä¸€äº›forwarding rules(SJF)æ±ºå®šé †åº
    2. å¯ä»¥è¡¨ç¤ºå¾ˆè¤‡é›œçš„policyï¼Œé›–ç„¶leafæœƒè®Šå¾ˆå¤šå€‹
    3. Lightweight, å ç”¨é‹ç®—è³‡æºå°‘ï¼Œlatencyè¼ƒä½ => å¯ä»¥deployåˆ°SmartNICã€switch data plane

* Conversion Methodlogy
    1.   Traces collection
         * ä¸èƒ½æŠŠDNNçš„æ‰€æœ‰(state, action)éƒ½ç›´æ¥æ‹¿å»train decision tree
             * å¤ªèŠ±æ™‚é–“
             * ä¸ç¬¦åˆtarget policyçš„ç‹€æ…‹åˆ†å¸ƒ
             * æ¯çµ„(state, action)å°æ–¼è¦å„ªåŒ–çš„target policyæœ‰**ä¸åŒç¨‹åº¦çš„å½±éŸ¿**
         * ? Metis follows the **trajectoriesæ‰€æœ‰(state, action)** generated by the teacher DNNs
         * ? Let DNN policy take over the control on the **deviated
trajectory**, and **re-collect (state, action)** pair to refine the conversion
training

    2.   Resampling
            * decision treeçš„å„ªåŒ–ç›®æ¨™æ˜¯**single action**çš„accuracyï¼Œå†ç”¨åŒå€‹æ–¹å¼å°å¾…å…¶ä»–action
            * ç¾å­˜çš„DL-based Network systemé€šå¸¸ä»¥RLçš„æ–¹å¼å„ªåŒ–**policy**ç‚ºä¸»ï¼Œè€Œä¸æ˜¯å„ªåŒ–å„action
                * å„çµ„(state, action)çš„advantage functionä»£è¡¨å…¶å°å„ªåŒ–ç›®æ¨™çš„é‡è¦ç¨‹åº¦
            * å¯ä»¥çœ‹å‡ºRLå’Œdecision treeçš„å„ªåŒ–ç›®æ¨™ä¸åŒï¼Œæ•…ä¸é©åˆå°‡æ¯ä¸€çµ„(state, action)éƒ½å¹³ç­‰å°å¾…ï¼Œé€šé€šä¸Ÿåˆ°decision treeè£¡åštraining
            * paperèªç‚ºæ‡‰è©²è¦ä¾æ“šå„çµ„(state, action)çš„é‡è¦ç¨‹åº¦ï¼Œæ±ºå®šé€™çµ„(state, action)è¦è¢«resampleèµ·ä¾†ï¼Œä¸Ÿåˆ°decision treeè£¡trainçš„æ©Ÿç‡
            ![](https://i.imgur.com/ps4yaLw.png)

    3.   Pruning
            * åˆ©ç”¨cost complexity pruning(CCP)ï¼Œé€éä¸€å€‹cost functionæ±ºå®šç•¶å‰nodeçš„sub-treeå¤§å°ï¼Œè—‰æ­¤æ±ºå®šè¦ä¸è¦ä¿ç•™è©²Node
            * å°æ–¼è¼ƒå¤§çš„ç¶²è·¯ç’°å¢ƒï¼Œæ”¹æˆä½¿ç”¨regression tree

    4.   Deployment
            * å¯ä»¥ç›´æ¥deployè½‰æ›å¾Œçš„decision treeï¼Œperformance diff. < 2%


## 5 HYPERGRAPH INTERPRETATIONS
* Hypergraph:
    * Vertex, Hyperedgeå„è¡¨ç¤ºä¸€ç¨®è®Šæ•¸
    * e.g. SDN routing optimization
        * vertex: Physical Link
        * hyperedge: Path(src-dst pairs)
* é©ç”¨ç¯„åœ, æœ‰å…¶ä¸­ä¸€ç¨®å°±OK
    1. Graph-structured inputs or outputs
    2. Bivariate mapping
        * Resource allocation problem (reource-request)
        * e.g. NF placement, UE-Base station coverage
* ç›®æ¨™
    * æ‰¾å‡ºhypergraphå“ªäº›vertex-hyperedge **connections**, æœƒå°å„ªåŒ–ç›®æ¨™æœ‰é‡è¦å½±éŸ¿
    * e.g. SDN routing optimizationç•¶ä¸­ï¼Œå“ªäº›(link, path) connectionå°æ•´é«”routing resultæœ‰é‡è¦å½±éŸ¿
* ç¬¦è™Ÿå®šç¾©
    * Incidence matrix I: 
        * è¡¨ç¤ºvertex-hyperedge connectionsé€£ç·šç‹€æ³, åªæœ‰0,1
    * Fractional Incidence matric W: 
        * è¡¨ç¤ºvertex-hyperedge connectionsé€£ç·šé‡è¦ç¨‹åº¦ï¼Œ 0~1ä¹‹é–“å°æ•¸
* Formulation
    * ç›®æ¨™
        * æ‰¾åˆ°ä¸€çµ„Wï¼Œä½¿å¾—loss functionæœ€å°
        * ![](https://i.imgur.com/QK9hhzk.png)
   
   * Performance degradation $D(Y_W, Y_I)$
        * $Y_W$: inputä¸è®Šï¼ŒåŸå…ˆDL modelçš„output
        * $Y_I$: inputç”¨W matrix maskedï¼Œå†ä¸Ÿåˆ°DL modelå¾Œçš„output
        * $D(Y_W, Y_I)$: è¨ˆç®—å…©è€…é–“çš„similarityï¼Œä¾æ“šoutputé¡å‹ç”¨ä¸åŒå…¬å¼è©•ä¼°
            * é€£çºŒ: MSE
            * é›¢æ•£: KL-divergence (e.g. sequences of routing decisions)
        * ![](https://i.imgur.com/AEy6vVG.png)
    * Interpretation conciseness $||W||$
        * penalty, é¿å…å–**å¤ªå¤šå€‹**critical connections
        * å¦‚æœå–W=Içš„è©±ï¼Œé›–ç„¶ $D(Y_W, Y_I)$æœƒå¾ˆå°ï¼Œä½†é€™ä¸€é …æœƒè®Šå¾ˆå¤§
        * ![](https://i.imgur.com/KdTqbEs.png)
    * Determinism $H(W)$
        * å¸Œæœ›W matrixçš„çµæœæ˜¯determisticçš„ï¼Œ$W_{ev}$çš„å€¼ç›¡é‡æ¥è¿‘0æˆ–1
        * è¨ˆç®—$W_{ev}$çš„entropyï¼Œentropyè¶Šå°è¡¨ç¤ºè¨Šæ¯å«é‡è¶Šä½ï¼Œ$W_{ev}$ä¹Ÿå°±è¶Šdetermistic(æ¥è¿‘0 or 1)
        * ![](https://i.imgur.com/woxMiM3.png)
    * Hyperparameters $ğœ†_1, ğœ†_2$
        * ä¾›ç¶²ç®¡äººå“¡éœ€æ±‚å‹•æ…‹èª¿æ•´
        * $ğœ†_1$èª¿é«˜ => penaltyè®Šé«˜ => critical conn.æ¸›å°‘
        * $ğœ†_2$èª¿é«˜ => $W_{ev}$è¶Šè¶¨è¿‘0æˆ–1 => critical conn.è®Šå¤š

## 6 EXPERIMENTS
1. System interpretations
2. Guide for model design
3. Enabling debuggability
4. Lightweight deployment
5. Ad-hoc adjustments

## 7 Discussion & Conclution



## Architecture
![](https://i.imgur.com/I9gw0Du.png)
